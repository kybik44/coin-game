<!DOCTYPE html>
<html lang="ru">
  <head>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="../../shared/js/balance.js"></script>
    <script src="../../shared/js/api.js"></script>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <meta name="format-detection" content="telephone=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Rewards - VAI Game</title>
    <link rel="stylesheet" href="../../shared/styles/common.css" />
    <link rel="stylesheet" href="rewards.css" />

    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        console.log("[Rewards] DOMContentLoaded event fired");

        try {
          if (!window.TelegramManager) {
            throw new Error("TelegramManager not available");
          }

          console.log("[Rewards] Starting initialization...");

          if (!(await TelegramManager.init())) {
            console.error("Telegram WebApp not initialized");
            return;
          }

          // Добавляем обработчик клика на шар
          addBalloonClickHandler();
          console.log("Added balloon click handler");
        } catch (error) {
          console.error("[Rewards] Initialization error:", error);
        }
      });
    </script>
  </head>
  <body>
    <div id="main-container" class="main-container">
      <div class="header">
        <div class="roadmap-link">
          <span class="roadmap-text"
            ><span class="roadmap-line">|</span> Check VAI's roadmap</span
          >
        </div>
        <a href="../roadmap/roadmap.html" class="roadmap-link aa"
          ><svg
            width="70"
            height="10"
            viewBox="0 0 70 18"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M70 2 L78 10 L70 18"
              stroke="white"
              stroke-width="2"
              fill="none"
            />
            <line
              x1="2"
              y1="10"
              x2="78"
              y2="10"
              stroke="white"
              stroke-width="2"
            />
          </svg>
        </a>
      </div>

      <div class="rewards-screen">
        <div class="main-title">Tap to claim</div>
        <div class="balloon-container">
          <div class="balloon balloon-closed">
            <img
              src="../../images/central-image.png"
              alt="balloon"
              class="balloon-closed"
            />
            <img
              src="../../images/central-image-open.png"
              alt="balloon open"
              class="balloon-open"
            />
          </div>
        </div>
        <div class="balance-container">
          <div class="balanceAmount">0</div>
          <div class="balance-currency">
            <img src="../../images/vaiicon.svg" alt="VAI" class="vai-icon" />
          </div>
        </div>
        <div class="timer">Next claim in <span id="timer">00:00:00</span></div>
        <button
          id="Task-button"
          class="white-button"
          onclick="window.location.href='../Tasks/Tasks.html'"
        >
          Tasks
        </button>
      </div>

      <div class="Nav">
        <button class="nav-item active">
          <img src="../../images/rewards.svg" alt="Rewards" />
          <span>Rewards</span>
        </button>
        <button
          class="nav-item"
          onclick="window.location.href='../high-stakes/high-stakes.html'"
        >
          <img src="../../images/highstakes.svg" alt="High Stakes" />
          <span>High Stakes</span>
        </button>
        <button
          class="nav-item"
          onclick="window.location.href='../referrals/referrals.html'"
        >
          <img src="../../images/referrals.svg" alt="Referrals" />
          <span>Referrals</span>
        </button>
        <button
          class="nav-item"
          onclick="window.location.href='../airdrop/airdrop.html'"
        >
          <img src="../../images/airdrop.svg" alt="Airdrop" />
          <span>Airdrop</span>
        </button>
      </div>
    </div>

    <script>
      console.log("HTML loaded, checking scripts...");
      window.addEventListener(
        "error",
        function (e) {
          if (e.target.tagName === "SCRIPT") {
            console.error("Script loading error:", e.target.src);
          }
        },
        true
      );
    </script>

    <script src="../../shared/js/components.js"></script>
    <script src="rewards.js" defer></script>
  </body>
</html>
